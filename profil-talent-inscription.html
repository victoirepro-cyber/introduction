<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Inscription - Profil Talent</title>

<style>
  *{ box-sizing:border-box; }
  body{
    margin:0;
    font-family: Arial, sans-serif;
    background:#ffffff;
  }

  /* Zone globale comme ta maquette (fond bleu clair) */
  .screen{
    min-height:100vh;
    display:flex;
    background: linear-gradient(to right, #ffffff 0%, #ffffff 30%, #a8c2da 100%);
  }

  /* Menu gauche gris */
  .sidebar{
    width:220px;
    padding:0;
    min-height:100vh;
    display:flex;
    flex-direction:column;
    background:#fff;
  }

  .logo img{
    max-width:220px;
    height:auto;
    display:block;
  }

  .menu{
    background-color:#fff;
    flex:1;
    padding:20px;
    border: 1.5px solid #2f5fa7;  /* encadrement bleu léger */
    border-radius: 10px;          /* coins arrondis */
  }

  .menu a{
    display:block;
    margin:35px 0;
    text-decoration:none;
    color:black;
    font-style:italic;
  }

  .menu a:hover{color:red}

  .menu a.active{
    font-size:22px;
    font-weight:bold;
    color:red;
  }

  .dropdown{position:relative;margin:20px 0;}

  .dropbtn{
    display:block;
    text-decoration:none;
    color:black;
    font-style:italic;
  }

  .dropbtn:hover{color:red;}

  .dropdown-content{
    display:none;
    margin-top:8px;
    margin-left:12px;
    border-left:2px solid #eee;
    padding-left:12px;
  }

  .dropdown-content a{
    display:block;
    margin:10px 0;
    text-decoration:none;
    color:#333;
    font-style:normal;
    font-size:14px;
  }

  .dropdown-content a:hover{color:red;}
  .dropdown:hover .dropdown-content{display:block;}

  /* Zone contenu */
  .content{
    flex:1;
    padding:30px 22px;
  }

  .title{
    text-align:center;
    color:#b71c1c;
    font-size:34px;
    letter-spacing:1px;
    margin:18px 0 10px;
    font-weight:500;
  }

  .subtitle{
    text-align:center;
    margin:0 0 20px;
    font-size:16px;
    color:#111;
    font-weight:700;
  }

  .badge{
    display:inline-block;
    padding:6px 10px;
    border-radius:999px;
    border:1.5px solid #2f5fa7;
    font-size:13px;
    font-weight:700;
    background:#fff;
  }

  /* Formulaire centré */
  .form-area{
    max-width:900px;
    margin:0 auto;
    padding-top:10px;
  }

  .section{
    background:#ffffff;
    border:1.5px solid #2f5fa7;
    border-radius:12px;
    padding:18px 16px;
    margin:16px 0;
  }

  .section h3{
    margin:0 0 12px;
    font-size:20px;
    color:#2f5fa7;
  }

  .hint{
    margin:0 0 12px;
    font-size:14px;
    line-height:1.35;
    color:#333;
  }

  .row{
    display:grid;
    grid-template-columns: 230px 1fr;
    gap:20px;
    align-items:center;
    margin:18px 0;
  }

  .row label{
    font-size:18px;
    font-weight:700;
    color:#111;
  }

  .row .labelline{
    display:flex;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
  }

  .tag-modif{
    display:none;
    font-size:12px;
    font-weight:800;
    color:#b71c1c;
    border:1px solid #b71c1c;
    padding:3px 8px;
    border-radius:999px;
  }

  .row input[type="text"],
  .row input[type="password"],
  .row input[type="email"]{
    height:45px;
    width:100%;
    border:2px solid #9e9e9e;
    background:#ffffff;
    padding:10px 12px;
    outline:none;
  }

  /* Boutons */
  .actions{
    margin-top:14px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:12px;
  }

  .btn-primary{
    width:260px;
    height:46px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-size:18px;
    font-weight:800;
    color:#fff;
    background:#2f5fa7;
  }
  .btn-primary:hover{ filter:brightness(0.95); }

  .btn-secondary{
    width:260px;
    height:46px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-size:16px;
    font-weight:800;
    color:#fff;
    background:#777;
  }

  /* Message feedback */
  .msg{
    margin-top:8px;
    text-align:center;
    font-size:16px;
    font-weight:800;
  }
  .msg.ok{ color:#1b5e20; }
  .msg.err{ color:#b71c1c; }

  /* Ligne "Déjà inscrit" */
  .already{
    margin-top:10px;
    text-align:center;
    font-size:16px;
    font-weight:700;
  }
  .already a{
    color:#1565c0;
    text-decoration:underline;
  }

  /* Responsive */
  @media (max-width: 850px){
    .screen{ flex-direction:column; }
    .sidebar{ width:100%; }
    .row{ grid-template-columns:1fr; }
  }
</style>
</head>

<body>
  <div class="screen">

    <!-- MENU GAUCHE -->
    <div class="sidebar">
      <div class="logo">
        <img src="images/LOGO I-JOM.jpg" alt="Logo I-JOM">
      </div>

      <div class="menu">
        <a href="index.html">ACCUEIL</a>
        <a href="apropos.html">A PROPOS DE NOUS</a>

        <!-- PROFIL TALENT (dropdown) -->
        <div class="dropdown">
          <span class="dropbtn active">PROFIL TALENT ▾</span>
          <div class="dropdown-content">
            <a href="profil-talent-connexion.html">Connexion</a>
            <a href="profil-talent-moncompte.html">Mon Compte</a>
            <!-- ✅ Lien menu vers cette page -->
            <a href="profil-talent-inscription.html" class="active">Inscription</a>
          </div>
        </div>

        <!-- RECRUTEUR (dropdown) -->
        <div class="dropdown">
          <span class="dropbtn">RECRUTEUR ▾</span>
          <div class="dropdown-content">
            <a href="recruteur-connexion.html">Connexion</a>
            <a href="recruteur-moncompte.html">Mon Compte</a>
            <a href="recruteur-inscription.html">Inscription</a>
          </div>
        </div>

        <a href="partenaires.html">NOS PARTENAIRES</a>
        <a href="contact.html">NOUS CONTACTER</a>
      </div>
    </div>

    <!-- CONTENU -->
    <main class="content">
      <div class="title">INSCRIPTION PROFIL TALENT</div>
      <p class="subtitle">
        <span class="badge" id="modeBadge">Mode : Création de compte</span>
      </p>

      <div class="form-area">
        <form id="signupForm" action="#" method="post" novalidate>

          <!-- ✅ PARTIE 1 : Accès direct au compte (Création / Modification) -->
          <div class="section">
            <h3>1) Accès direct au compte</h3>
            <p class="hint">
              Cette partie permet de <b>créer votre compte</b> (email, login, mot de passe) ou de <b>modifier</b> ces informations si vous êtes déjà connecté(e).
            </p>

            <div class="row">
              <div class="labelline">
                <label for="email">Adresse mail</label>
                <span class="tag-modif" id="tagEmail">MODIFIER</span>
              </div>
              <input id="email" name="email" type="email" autocomplete="email" required placeholder="ex: nom.prenom@email.com">
            </div>

            <div class="row">
              <div class="labelline">
                <label for="login">Login</label>
                <span class="tag-modif" id="tagLogin">MODIFIER</span>
              </div>
              <input id="login" name="login" type="text" autocomplete="username" required placeholder="Choisissez un login">
            </div>

            <div class="row">
              <div class="labelline">
                <label for="mdp">Mot de passe</label>
                <span class="tag-modif" id="tagMdp">MODIFIER</span>
              </div>
              <input id="mdp" name="password" type="password" autocomplete="new-password" required placeholder="Choisissez un mot de passe">
            </div>

            <div class="actions">
              <button type="submit" class="btn-primary" id="btnSubmit">Créer mon compte</button>
              <button type="button" class="btn-secondary" id="btnGoAccount" style="display:none;">Aller à Mon Compte</button>
              <div class="msg" id="msg" aria-live="polite"></div>
            </div>

            <div class="already">
              Déjà inscrit(e) ? <a href="profil-talent-connexion.html">Se connecter</a>
            </div>
          </div>

          <!-- ✅ PARTIE 2 : Profil (placeholder) -->
          <div class="section">
            <h3>2) Enregistrement des informations du profil</h3>
            <p class="hint">
              Cette partie sera détaillée plus tard (informations personnelles, compétences, parcours, etc.).<br>
              Pour l’instant, vous pouvez créer/modifier votre compte puis continuer ensuite.
            </p>

            <!-- Placeholder minimal -->
            <div class="row">
              <label for="profileNote">Informations du profil (à venir)</label>
              <input id="profileNote" type="text" placeholder="(Ex: À compléter plus tard)" disabled>
            </div>
          </div>

        </form>
      </div>
    </main>

  </div>

<script>
  // =========================
  //  Liaison Inscription -> Connexion -> Mon Compte (DEMO localStorage)
  // =========================

  // Clés de stockage
  const KEY_ACCOUNT  = "talentAccount";  // {email, login, password, createdAt, updatedAt}
  const KEY_SESSION  = "talentSession";  // {login, connected, connectedAt}

  const form = document.getElementById("signupForm");
  const emailInput = document.getElementById("email");
  const loginInput = document.getElementById("login");
  const passInput  = document.getElementById("mdp");

  const msg = document.getElementById("msg");
  const btnSubmit = document.getElementById("btnSubmit");
  const btnGoAccount = document.getElementById("btnGoAccount");
  const modeBadge = document.getElementById("modeBadge");

  const tagEmail = document.getElementById("tagEmail");
  const tagLogin = document.getElementById("tagLogin");
  const tagMdp   = document.getElementById("tagMdp");

  function setMessage(text, type){
    msg.textContent = text;
    msg.className = "msg " + (type || "");
  }

  function readJSON(key){
    const raw = localStorage.getItem(key);
    if(!raw) return null;
    try { return JSON.parse(raw); } catch(e){ return null; }
  }

  function writeJSON(key, value){
    localStorage.setItem(key, JSON.stringify(value));
  }

  function getAccount(){
    return readJSON(KEY_ACCOUNT);
  }

  function getSession(){
    return readJSON(KEY_SESSION);
  }

  function isConnected(){
    const s = getSession();
    return !!(s && s.connected === true && s.login);
  }

  function showModifyMode(account){
    modeBadge.textContent = "Mode : Modification du profil / Compte";
    btnSubmit.textContent = "Enregistrer les modifications";
    btnGoAccount.style.display = "block";

    // Pré-remplissage
    emailInput.value = account?.email || "";
    loginInput.value = account?.login || "";
    // Mot de passe : on laisse vide (plus propre), mais tu peux le préremplir si tu veux.
    passInput.value = "";

    // Afficher les mentions "MODIFIER"
    tagEmail.style.display = "inline-block";
    tagLogin.style.display = "inline-block";
    tagMdp.style.display   = "inline-block";
  }

  function showCreateMode(){
    modeBadge.textContent = "Mode : Création de compte";
    btnSubmit.textContent = "Créer mon compte";
    btnGoAccount.style.display = "none";

    tagEmail.style.display = "none";
    tagLogin.style.display = "none";
    tagMdp.style.display   = "none";
  }

  // ✅ Au chargement : si connecté -> mode modification
  (function init(){
    const account = getAccount();
    if(isConnected() && account){
      showModifyMode(account);
      setMessage("Vous êtes déjà connecté(e). Vous pouvez modifier vos informations.", "ok");
    }else{
      showCreateMode();
    }
  })();

  btnGoAccount.addEventListener("click", function(){
    window.location.href = "profil-talent-moncompte.html";
  });

  function isValidEmail(v){
    // Simple validation
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
  }

  form.addEventListener("submit", function(e){
    e.preventDefault();

    const email = (emailInput.value || "").trim();
    const login = (loginInput.value || "").trim();
    const password = passInput.value || "";

    if(!email || !login || !password){
      setMessage("Veuillez remplir l’adresse mail, le login et le mot de passe.", "err");
      return;
    }

    if(!isValidEmail(email)){
      setMessage("Adresse mail invalide. Exemple : nom.prenom@email.com", "err");
      return;
    }

    const existing = getAccount();
    const connected = isConnected();

    // ✅ Cas 1 : Pas connecté -> Création
    if(!connected){
      // Si un compte existe déjà sur le même navigateur (démo)
      if(existing){
        setMessage("Un compte existe déjà sur cet appareil. Veuillez vous connecter ou passer en modification du profil.", "err");
        return;
      }

      const newAccount = {
        email,
        login,
        password,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString()
      };

      writeJSON(KEY_ACCOUNT, newAccount);
      writeJSON(KEY_SESSION, { login: newAccount.login, connected: true, connectedAt: new Date().toISOString() });

      setMessage("Compte créé avec succès. Redirection vers Mon Compte…", "ok");
      window.location.href = "profil-talent-moncompte.html";
      return;
    }

    // ✅ Cas 2 : Connecté -> Modification
    if(!existing){
      // Session ok mais pas de compte (rare), on recrée
      const rebuilt = {
        email,
        login,
        password,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString()
      };
      writeJSON(KEY_ACCOUNT, rebuilt);
      writeJSON(KEY_SESSION, { login: rebuilt.login, connected: true, connectedAt: new Date().toISOString() });
      setMessage("Informations enregistrées. (Compte recréé) ✅", "ok");
      return;
    }

    // Mise à jour
    const updated = {
      ...existing,
      email,
      login,
      // mot de passe : on remplace
      password,
      updatedAt: new Date().toISOString()
    };

    writeJSON(KEY_ACCOUNT, updated);
    // Mettre à jour la session si login changé
    writeJSON(KEY_SESSION, { login: updated.login, connected: true, connectedAt: new Date().toISOString() });

    setMessage("Modifications enregistrées avec succès ✅", "ok");
  });
</script>

</body>
</html>
